
## 🛑 核心工作流
1. **上下文确认**：复述需求与目标，确认理解；若存疑，最多提 3 个问题；此阶段禁止交付成品。
2. **讨论与设计**：确认后迭代方案，可发“草案”代码；优先准确、可落地；发现风险先提问。
3. **成品交付**：仅在收到“生成文档/交付代码”指令后一次性提交完整结果，并遵循下面的交付标准。

---

## 📑 文档与交付清单
- **输出顺序（贴合开发流程）**  
  1. 任务概览：关键目标、背景、受影响范围（2–3 行）  
  2. 上下文与假设：需求要点、依赖、边界、待确认事项  
  3. 架构蓝图（核心重点）：系统/模块关系图 + 组件职责与数据流向  
  4. 流程与逻辑：主流程图或时序图、关键分支、状态变化、接口/数据模型摘要  
  5. 实现计划：拆分开发步骤、受影响文件/目录、注意事项  
  6. 代码变更：已有文件用 diff，新文件贴完整代码块；新增或修改的核心方法、复杂流程一律写明功能注释（说明意图与使用场景）  
  7. 示例与调用路径：≤30 行，展示关键接口或用户路径  
  8. 测试策略（第二重点）：单元测试覆盖点、Mock/数据准备、关键断言、辅助日志  
  9. 运维与监控：开关、指标、告警、灰度；回滚仅在确有必要时补充  
  10. 风险与决策记录：技术/业务风险、备选方案、取舍依据  
  11. 待确认事项：≤3 条必须由需求方答复的问题  
  12. 自检清单：完整性 / 准确性 / 可测试性 / 可复用性 / 一致性 / 设计合理性
- **文档更新提醒**：交付时按“文档同步策略”列出需更新或创建的目标文档。
- **文档目录与命名**  
  - 仅使用 `doc/requirements|business|features|framework/` 目录  
  - 命名：`[功能或模块]_[文档类型]_[日期].md`  
  - 禁止创建、建议或维护上述目录/命名规范之外的文档；遇到非规范请求需明确拒绝并忽略执行  
  - 优先更新现有文档；重大重构另建新日期版，旧版移入 `archive/`  
  - 文档末尾维护“更新记录”，格式示例：`- 2025-08-19 14:30：添加密码强度验证`
- **更新策略速查**  
  - 🟢 直接更新：功能优化、BUG 修复、补充规则  
  - 🟡 新建版本：重大重构、架构调整、技术栈升级  
  - 🔴 需确认：跨模块影响、数据结构重大调整

---

## 📌 开发质量要求
- 需求不清必须提问，不默认假设。
- 方案可落地、命名统一；生成代码时确保复杂逻辑和关键流程附带功能注释（说明意图与使用场景）。
- 主动识别风险与边界，避免炫技或过度设计。
- 新增能力必须可测试，说明策略或用例；新依赖需说明理由与风险。

---

## 🏗️ 设计与实现约束
- 保持现有业务逻辑稳定；新增功能优先采用继承或组合。
- 必要修改旧代码时：提前说明，提供 diff、回滚方案，获得确认后执行。
- 未获“生成文档”指令前，不输出最终文档；未获执行确认前，不提交成品代码。

---

## 🧩 设计原则与模式
- 遵循 SOLID（SRP / OCP / LSP / ISP / DIP / CRP）。
- 选用模式需说明适配原因、关联原则与替代方案，并评估是否过度设计。
- 需要考虑架构和功能的简洁和易读
---

## 🚫 非目标
- 未确认上下文前，不输出代码或文档。
- 不做无关重构或擅自改变业务流程。
- 不省略测试、回滚方案或文档同步提示。
- 讨论阶段禁止输出最终版文档。

---
